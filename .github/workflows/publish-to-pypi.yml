name: Publish Python Package to PyPI

on:
release:
types: [published]

jobs:
deploy:
runs-on: ubuntu-latest

# This permissions block is crucial for Trusted Publishing
# It allows the workflow to request a special OIDC token
permissions:
  id-token: write
  contents: read

steps:
- uses: actions/checkout@v3
- name: Set up Python
  uses: actions/setup-python@v4
  with:
    python-version: '3.x'
- name: Install dependencies
  run: |
    python -m pip install --upgrade pip
    pip install build
- name: Build package
  run: python -m build

- name: Publish package to PyPI
  uses: pypa/gh-action-pypi-publish@release/v1
  # Note: The 'user' and 'password' fields are no longer needed
  # because the action will automatically use Trusted Publishers.
